{{! @template block_faces/faces_page }}
<section class="faces-page{{#isprint}} faces-page--print{{/isprint}}">
    <header class="faces-page__header">
        <div class="faces-page__heading">
            <h2 class="faces-page__title">{{coursename}}</h2>
            <p class="faces-page__date">{{currentdate}}</p>
        </div>

        {{#showfilters}}
        <div class="faces-page__controls">
            <div class="faces-page__control faces-page__control--orderby">{{{orderbyselect}}}</div>
            <div class="faces-page__control faces-page__control--group">{{{groupselect}}}</div>
            <div class="faces-page__control faces-page__control--print">
                <a class="btn btn-secondary" href="{{printurl}}" target="_blank">{{printlabel}}</a>
            </div>
        </div>
        {{/showfilters}}
    </header>

    {{#showgroupselection}}
    <section class="faces-groupselection faces-printgroups" data-region="faces-groupselection">
        <header class="faces-groupselection__header">
            <h3 class="faces-groupselection__title">{{groupselection.title}}</h3>
            <button
                type="button"
                class="faces-printgroups__sections-toggle"
                data-action="toggle-collapsible"
                data-target="{{groupselection.contentid}}"
                aria-controls="{{groupselection.contentid}}"
                aria-expanded="{{#groupselection.expanded}}true{{/groupselection.expanded}}{{^groupselection.expanded}}false{{/groupselection.expanded}}"
            >
                <span class="faces-printgroups__sections-toggle-icon" aria-hidden="true"></span>
                <span class="faces-printgroups__sections-toggle-label">{{groupselection.togglelabel}}</span>
            </button>
        </header>

        <div
            id="{{groupselection.contentid}}"
            class="faces-groupselection__content faces-printgroups__sections-content"
            {{^groupselection.expanded}}hidden{{/groupselection.expanded}}
        >
            {{#groupselection.hasgroupings}}
            <form method="get" action="{{groupselection.actionurl}}" class="faces-printgroups__form">
                <input type="hidden" name="cid" value="{{groupselection.courseid}}" />
                <input type="hidden" name="orderby" value="{{groupselection.orderby}}" />

                <div class="faces-printgroups__groupings">
                    {{#groupselection.groupings}}
                    <fieldset class="faces-printgroups__grouping">
                        <legend class="faces-printgroups__grouping-title">{{name}}</legend>
                        <ul class="faces-printgroups__groups" role="list">
                            {{#groups}}
                            <li class="faces-printgroups__group" role="listitem">
                                <label class="faces-printgroups__group-label">
                                    <input type="checkbox" name="groupids[]" value="{{id}}" class="faces-printgroups__checkbox" {{#checked}}checked{{/checked}} />
                                    <span class="faces-printgroups__group-name">{{name}}</span>
                                </label>
                            </li>
                            {{/groups}}
                        </ul>
                        <div class="faces-printgroups__grouping-togglecontainer">
                            <button
                                type="button"
                                class="faces-printgroups__grouping-toggle"
                                data-action="toggle-grouping"
                                data-select-label="{{selectalllabel}}"
                                data-deselect-label="{{deselectalllabel}}"
                                aria-pressed="false"
                            >
                                <em class="faces-printgroups__grouping-toggle-text">{{selectalllabel}}</em>
                            </button>
                        </div>
                    </fieldset>
                    {{/groupselection.groupings}}
                </div>

                <div class="faces-printgroups__actions">
                    <button type="submit" class="btn btn-primary">{{groupselection.submitlabel}}</button>
                    {{#groupselection.showreset}}
                    <a class="btn btn-secondary" href="{{groupselection.reseturl}}">{{groupselection.resetlabel}}</a>
                    {{/groupselection.showreset}}
                </div>
            </form>
            {{/groupselection.hasgroupings}}

            {{^groupselection.hasgroupings}}
            <div class="faces-page__empty faces-printgroups__empty">{{groupselection.nogroupsavailable}}</div>
            {{/groupselection.hasgroupings}}
        </div>
    </section>
    {{/showgroupselection}}

    {{#displaysections}}
    <div class="faces-printgroups__sections" data-region="faces-sections">
        <div class="faces-printgroups__sections-content" data-region="faces-sections-content">
            {{#sections}}
            <section class="faces-printgroups__section">
                <header class="faces-printgroups__section-header">
                    <h3 class="faces-printgroups__section-title">{{groupname}}</h3>
                </header>

                {{#hasusers}}
                <ul class="faces-grid" role="list">
                    {{#users}}
                    <li class="faces-grid__item" role="listitem">
                        <a class="faces-grid__link" href="{{profileurl}}">
                            <span class="faces-grid__avatar">
                                <img src="{{picture}}" alt="{{fullname}}" class="faces-grid__image" />
                            </span>
                            <span class="faces-grid__name">{{fullname}}</span>
                        </a>
                    </li>
                    {{/users}}
                </ul>
                {{/hasusers}}

                {{^hasusers}}
                <div class="alert alert-info faces-page__empty">{{nousers}}</div>
                {{/hasusers}}
            </section>
            {{/sections}}
        </div>
    </div>
    {{/displaysections}}

    {{^displaysections}}
        {{#hasusers}}
        <ul class="faces-grid" role="list">
            {{#users}}
            <li class="faces-grid__item" role="listitem">
                <a class="faces-grid__link" href="{{profileurl}}">
                    <span class="faces-grid__avatar">
                        <img src="{{picture}}" alt="{{fullname}}" class="faces-grid__image" />
                    </span>
                    <span class="faces-grid__name">{{fullname}}</span>
                </a>
            </li>
            {{/users}}
        </ul>
        {{/hasusers}}
        {{^hasusers}}
        <div class="alert alert-info faces-page__empty">{{nousers}}</div>
        {{/hasusers}}
    {{/displaysections}}
</section>

{{#js}}
require(['block_faces/faces'], function(module) {
    {{#isprint}}
    module.initPrint();
    {{/isprint}}
    {{^isprint}}
    module.init();
    {{/isprint}}
});
{{/js}}
